<nav class="navbar navbar-expand-lg navbar-custom fixed-top">
  <div class="container">
    <a class="navbar-brand navbar-brand-custom" href="#">
      <i class="bi bi-piggy-bank-fill me-2"></i>Your Money 2.0
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link nav-link-custom" href="/dashboard">
            <i class="bi bi-house-door me-1"></i>Dashboard
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-custom" href="/receitas">
            <i class="bi bi-arrow-up-circle me-1"></i>Receitas
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-custom" href="/despesas">
            <i class="bi bi-arrow-down-circle me-1"></i>Despesas
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-custom active" href="/investimento">
            <i class="bi bi-graph-up-arrow me-1"></i>Investimentos
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-custom" href="/metas">
            <i class="bi bi-bullseye me-1"></i>Metas
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="investimento-page">
  <div class="page-header">
    <h1 class="page-title">Investimentos</h1>
  </div>

  <!-- Loading Spinner -->
  <!-- <div *ngIf="loading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Carregando...</span>
    </div>
  </div> -->

  <!-- Content -->
  <!-- <div *ngIf="!loading"> -->
  <!-- Summary Cards -->
  <!-- <div class="row mb-4">
      <div class="col-md-4 mb-3">
        <div class="card summary-card">
          <div class="card-body">
            <div class="card-icon">
              <i class="bi bi-cash-coin"></i>
            </div>
            <h5 class="card-title">Total Investido</h5>
            <h3 class="card-value">{{ formatarMoeda(resumo.totalInvestido) }}</h3>
            <p class="card-description">Valor total aplicado em investimentos</p>
          </div>
        </div>
      </div>

      <div class="col-md-4 mb-3">
        <div class="card summary-card">
          <div class="card-body">
            <div class="card-icon">
              <i class="bi bi-graph-up"></i>
            </div>
            <h5 class="card-title">Rentabilidade</h5>
            <h3 class="card-value positive">
              +{{ formatarMoeda(resumo.patrimonioTotal - resumo.totalInvestido) }} 
              ({{ formatarPercentual(resumo.rentabilidade) }})
            </h3>
            <p class="card-description">Ganho acumulado nos últimos 12 meses</p>
          </div>
        </div>
      </div>

      <div class="col-md-4 mb-3">
        <div class="card summary-card">
          <div class="card-body">
            <div class="card-icon">
              <i class="bi bi-briefcase"></i>
            </div>
            <h5 class="card-title">Patrimônio Total</h5>
            <h3 class="card-value">{{ formatarMoeda(resumo.patrimonioTotal) }}</h3>
            <p class="card-description">Valor atual da carteira de investimentos</p>
          </div>
        </div>
      </div>
    </div> -->

  <!-- Performance Chart -->
  <!-- <div class="card mb-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Evolução do Patrimônio</h5>
        <select class="form-select form-select-sm" style="width: auto;">
          <option>Últimos 12 meses</option>
          <option>Últimos 6 meses</option>
          <option>Últimos 3 meses</option>
        </select>
      </div>
      <div class="card-body">
        <div class="chart-placeholder">
          <i class="bi bi-bar-chart-line"></i>
          <p>Gráfico de evolução do patrimônio (integração futura com biblioteca de gráficos)</p>
        </div>
      </div>
    </div> -->

  <!-- Investment Portfolio -->
  <div class="card mb-4">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Minha Carteira</h5>
      <button class="btn btn-primary" (click)="abrirModalInvestimento()">
        <i class="bi bi-plus-circle"></i> Adicionar Investimento
      </button>
    </div>
    <!-- Modal de Cadastro -->
    <div class="modal fade" id="modalInvestimento" tabindex="-1" aria-labelledby="modalInvestimentoLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalInvestimentoLabel">Novo Investimento</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="row g-3">
                <div class="col-12">
                  <label class="form-label">Nome</label>
                  <input type="text" class="form-control" [(ngModel)]="novoInvestimento.nome" name="nome" required />
                </div>
                <div class="col-12">
                  <label class="form-label">Descrição</label>
                  <input type="text" class="form-control" [(ngModel)]="novoInvestimento.descricao" name="descricao"
                    required />
                </div>
                <div class="col-12">
                  <label class="form-label">Tipo</label>
                  <input type="text" class="form-control" [(ngModel)]="novoInvestimento.tipo" name="tipo" required />
                </div>
                <div class="col-md-6">
                  <label class="form-label">Quantidade</label>
                  <input type="number" step="0.01" class="form-control" [(ngModel)]="novoInvestimento.quantidade"
                    name="quantidade" required />
                </div>
                <div class="col-md-6">
                  <label class="form-label">Preço Médio (R$)</label>
                  <input type="number" step="0.01" class="form-control" [(ngModel)]="novoInvestimento.precoMedio"
                    name="precoMedio" required />
                </div>
                <div class="col-md-6">
                  <label class="form-label">Valor (R$)</label>
                  <input type="number" step="0.01" class="form-control" [(ngModel)]="novoInvestimento.valorAtual"
                    name="valor" required />
                </div>
                <div class="col-md-6">
                  <label class="form-label">Data</label>
                  <input type="date" class="form-control" [(ngModel)]="novoInvestimento.dataInvestimento" name="data"
                    required />
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn" style="background-color: var(--blue-dark); color: var(--card-bg);"
              data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn"
              style="background-color: var(--blue-president); color: var(--card-bg); font-weight: 500;"
              (click)="salvarInvestimento()">Salvar Investimento</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Navegação por mês -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <button class="btn btn-outline-secondary btn-sm" (click)="mudarMes(-1)">&lt;</button>
      <h6 class="mb-0">{{ mesAtual | date:'MMMM/yyyy' : 'pt' }}</h6>
      <button class="btn btn-outline-secondary btn-sm" (click)="mudarMes(1)">&gt;</button>
    </div>
    <!-- Lista de Investimentos -->
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Tipo</th>
              <th>Quantidade</th>
              <th>Preço Médio</th>
              <th>Valor Atual</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let investimento of investimentos">
              <td>{{ investimento.nome }}</td>
              <td>{{ investimento.tipo }}</td>
              <td>{{ investimento.quantidade }} {{ investimento.tipo === 'Renda Variável' ? 'ações' : (investimento.tipo
                === 'Fundo' ? 'cotas' : 'unidades') }}</td>
              <td>{{ formatarMoeda(investimento.precoMedio) }}</td>
              <td>{{ formatarMoeda(investimento.valorAtual) }}</td>
              <td>
                <div class="action-buttons">
                  <button class="btn btn-sm btn-outline-primary me-1" (click)="abrirModalEditar(investimento)"
                    title="Editar">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-sm btn-outline-danger" (click)="deletarInvestimento(investimento.id)"
                    title="Excluir">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <!-- <div class="card mb-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Minha Carteira</h5>
        <button class="btn btn-primary" (click)="adicionarInvestimento()">
          <i class="bi bi-plus-circle"></i> Adicionar Investimento
        </button>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Ativo</th>
                <th>Tipo</th>
                <th>Quantidade</th>
                <th>Preço Médio</th>
                <th>Valor Atual</th>
                <th>Rentabilidade</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let investimento of investimentos">
                <td>{{ investimento.ativo }}</td>
                <td>{{ investimento.tipo }}</td>
                <td>{{ investimento.quantidade }} {{ investimento.tipo === 'Renda Variável' ? 'ações' : (investimento.tipo === 'Fundo' ? 'cotas' : 'unidades') }}</td>
                <td>{{ formatarMoeda(investimento.precoMedio) }}</td>
                <td>{{ formatarMoeda(investimento.valorAtual) }}</td>
                <td [class]="obterClasseRentabilidade(investimento.rentabilidade)">
                  {{ formatarPercentual(investimento.rentabilidade) }}
                </td>
                <td>
                  <div class="action-buttons">
                    <button class="btn btn-sm btn-outline-primary me-1" 
                            (click)="editarInvestimento(investimento.id)"
                            title="Editar">
                      <i class="bi bi-pencil"></i>
                    </button>
                    <button class="btn btn-sm btn-outline-danger" 
                            (click)="excluirInvestimento(investimento.id)"
                            title="Excluir">
                      <i class="bi bi-trash"></i>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div> -->

  <!-- Investment Categories -->
  <!-- <div class="card">
      <div class="card-header">
        <h5 class="mb-0">Distribuição por Categoria</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-4 mb-3" *ngFor="let categoria of distribuicao">
            <div class="card category-card">
              <div class="card-body text-center">
                <div class="category-icon">
                  <i class="bi" [ngClass]="{
                    'bi-bank': categoria.categoria === 'Renda Fixa',
                    'bi-graph-up': categoria.categoria === 'Renda Variável',
                    'bi-building': categoria.categoria === 'Fundos'
                  }"></i>
                </div>
                <h6 class="card-title">{{ categoria.categoria }}</h6>
                <h4 class="card-value">{{ formatarMoeda(categoria.valor) }}</h4>
                <p class="card-description">{{ categoria.percentual }}% da carteira</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> -->